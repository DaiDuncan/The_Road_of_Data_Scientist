# 基本概念

- 冯·诺依曼模型（**以存储器为核心**）

- 计算机系统的层次关系

  - 裸机→**虚拟机**/扩展机

  - 计算机硬件→**操作系统**→==编译程序==/安装程序→应用程序

- 操作系统实现了对硬件机器的扩展

- 操作系统提供了计算机硬件与用户之间的接口

- 操作系统的概念(不同角度的解释)

  - 用户观点

  - 系统观点（资源管理观点）
    资源分类：处理器、存储器、设备、==信息(程序和数据)==

  - 进程观点：==以并发工作为出发点；分为用户进程、系统进程==

  - 虚拟机观点（机器扩充观点）

- 操作系统的特征⭐

  - 并发性（基本特征）
    注意区分并发与并行；**单核CPU**同一时刻只能执行一个程序，各程序并发执行

  - 共享性（基本特征）
    ==互斥共享、同时访问==

  - 虚拟性

  - ==异步性==

  - attention①并发和共享互相依存

  - attention②没有并发和共享，就不存在虚拟和异步





# 操作系统的功能

- 处理器管理(进程管理)
  ==处理器的分配和运行，以进程为单位==；进程控制、**进程同步**、**进程通信**、进程调度

- 存储器管理
  内存分配、**内存保护**、内存扩充

- 设备管理
  设备分配、设备传输控制、设备独立性

- 文件管理
  文件存储空间管理、**目录管理**、文件操作管理、文件保护

- 用户接口

  - 命令接口

    - 联机命令接口/交互式命令接口——适用于**分时/实时操作系统**——每输入一条命令就执行

    - 脱机命令接口/批处理命令接口——适用于**批处理系统**——输入一组控制命令

  - 程序接口/系统调用

  - 图形接口（联机命令接口的图形化）



# 操作系统的发展

- ①无操作系统阶段
  手工操作方式→**通道技术→缓冲技术**→脱机输入/输出技术

- ②**单道批处理**系统
  自动性、顺序性、单道性

- ③**多道批处理**系统
  多道、宏观上并行、微观上串行

- ④操作系统产生！



# 操作系统的分类

- 批处理操作系统
  单道批处理操作系统——→多道批处理操作系统（用户脱机使用/成批处理/多道程序运行/**但无交互性**）

- 分时操作系统

  多路性、交互性、独占性、及时性；

  - 简单分时操作系统：(**内存只留一道作业**，其他都在外存)

  - **具有前台和后台**的分时操作系统

  - 多道分时操作系统：(**内存同时装入多道作业**)

- 实时操作系统

  比分时操作系统响应更快；提供**即时响应**和高可靠性

  - 实时控制系统——常用于生产过程控制(钢铁冶炼/化工炼油)

  - **实时信息处理系统——常用于票务订购/信息检索**

- 其他操作系统

  - **嵌入式操作系统**——电器类应用

  - ==集群系统——多系统耦合/可用性高==

  - 网络操作系统——**共享/互通信**

  - ==分布式操作系统——以较低成本获得高性能/可靠性高==



# 处理器执行状态

- 用户态/目态
  用户程序执行时机器所处的状态，只能执行规定的程序，访问制定的**寄存器和存储区**；

- 核心态/管态/系统态
  操作系统管理程序执行时机器所处的状态，具有较高特权，能执行特权指令，访问所有寄存器和存储区

- 补充1：特权指令
  **只能由操作系统内核部分使用**，如I/O指令、设置中断屏蔽指令、清内存指令、存储保护指令和设置时钟指令

- 补充2：内核指令内容
  时钟管理、中断机制、原语(关中断的公用小程序)、系统控制的数据结构及处理(用来登记状态的数据结构)



# 中断与异常的区别

异常会引起中断，中断不一定由异常引起

- 中断：又叫外中断，系统正常功能的一部分

- 异常：又叫内中断，由错误引起的，如文件损坏、进程越界



# 系统调用or广义指令

操作系统提供的用户接口之一，又叫程序接口或应用编程接口API；大概是供**用户来调用属于核心态的程序/信息等**！
​包括进程控制、文件系统控制、系统控制、内存管理、网络管理、socket控制、用户管理、进程间通信

- 具体流程

  - ①用户准备并**传递系统调用所需的参数**

  - ②通过trap指令**进入操作系统的内核，从用户态进入核心态**

  - ③执行相应的**系统调用函数**（完成特定的系统内核功能）

  - ④返回处理结果至用户程序，并从核心态返回用户态



# 操作系统的结构

- 模块组合结构——适用于早期os/小型os/使用环境稳定的os
  优点：接口简单/系统效率高；

  缺点：结构不清晰/可扩展性差/可适应性差

- 层次结构
  将所有功能模块按功能的调用次序，排列成若干层，**功能模块间只存在单向调用和单向依赖**

- 微内核结构

  ==os内核中只留基本功能==，其他的功能由用户态下的程序进行实现

  - 适用于**分布式系统**

  - 并不会提高系统的运行效率



# 知识补充

- 分时操作系统必须有交互功能！用户不会独占文件，是**多用户共享的**

- 系统调用是应用程序接口

- 操作系统为用户提供的接口：命令方式、系统调用、图形和窗口方式，**批处理命令和shell文件属于命令方式**

- 宏命令是指**用户和应用程序之间的接口**

- 用户态下访问内核引起的中断，叫访管中断，因为**内核态又叫管态**

- 程序中断是指程序执行过程中产生的一般中断，例如程序有使用磁盘的要求

- **缺页中断可以发生在用户态**，缺页中断的处理需要内核态执行

- 子程序调用不需要保存程序状态字

- 用户开机时先启动主板ROM上的BIOS程序，由它去调用操作系统，然后**os程序自动加载到内存中的系统区（RAM）**

- 常见会引起系统调用的函数：read、write、open、fopen；类似sin/cos这些不会引起系统调用

- 外部中断时，程序计数器内容由中断隐指令保存，而通用寄存器内容由操作系统保存

- **软中断在内核态进行**；访问addr需要进入内核态

- 多重处理=并行，**多任务处理=并发**；
  - 一个CPU可以采用多核架构实现并行执行

