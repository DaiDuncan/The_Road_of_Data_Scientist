[åšå®¢å›­](https://www.cnblogs.com/gongyanzh/p/12881741.html)

# ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº

LeetCodeå…¥å£ğŸ‘‰ğŸ‘‰ğŸ‘‰[No.121](https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock/)

ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ *i* ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬ *i* å¤©çš„ä»·æ ¼ã€‚

å¦‚æœä½ **æœ€å¤šåªå…è®¸å®Œæˆä¸€ç¬”äº¤æ˜“**ï¼ˆå³ä¹°å…¥å’Œå–å‡ºä¸€æ”¯è‚¡ç¥¨ä¸€æ¬¡ï¼‰ï¼Œè®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚

æ³¨æ„ï¼šä½ ä¸èƒ½åœ¨ä¹°å…¥è‚¡ç¥¨å‰å–å‡ºè‚¡ç¥¨ã€‚



**ç¤ºä¾‹ 1:**

```python
è¾“å…¥: [7,1,5,3,6,4]
è¾“å‡º: 5
è§£é‡Š: åœ¨ç¬¬ 2 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 5 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 6ï¼‰çš„æ—¶å€™å–å‡ºï¼Œæœ€å¤§åˆ©æ¶¦ = 6-1 = 5 ã€‚
     æ³¨æ„åˆ©æ¶¦ä¸èƒ½æ˜¯ 7-1 = 6, å› ä¸ºå–å‡ºä»·æ ¼éœ€è¦å¤§äºä¹°å…¥ä»·æ ¼ï¼›åŒæ—¶ï¼Œä½ ä¸èƒ½åœ¨ä¹°å…¥å‰å–å‡ºè‚¡ç¥¨ã€‚
```



**ç¤ºä¾‹ 2:**

```python
è¾“å…¥: [7,6,4,3,1]
è¾“å‡º: 0
è§£é‡Š: åœ¨è¿™ç§æƒ…å†µä¸‹, æ²¡æœ‰äº¤æ˜“å®Œæˆ, æ‰€ä»¥æœ€å¤§åˆ©æ¶¦ä¸º 0ã€‚
```



**æ€è·¯**

![image-20200513101058817](https://gitee.com/gongyanzh/blogpic/raw/master/pictures/image-20200513101058817.png)

æœ€å¤§æ”¶ç›Šå³æœ€å¤§å–å‡ºä»·æ ¼ä¸æœ€ä½ä¹°å…¥ä»·æ ¼ä¹‹å·®ï¼ˆæœ€ä½ç‚¹ä¹°å…¥ï¼Œæœ€é«˜ç‚¹å–å‡ºï¼‰

ä½¿ç”¨ä¸¤ä¸ªå˜é‡ï¼Œåˆ†åˆ«è¡¨ç¤º ç›®å‰ä¸ºæ­¢å¾—åˆ°çš„æœ€å¤§æ”¶ç›Šã€ç›®å‰ä¸ºæ­¢çš„æœ€ä½ä»·æ ¼

```python
maxprofit = max(maxprofit, price - minprice)
minprice = min(minprice, price)
```

**coding**

```python
class Solution:
    def maxProfit(self, prices: List[int]) -> int:
        if not prices:
            return 0
        maxprofit = 0
        minprice = prices[0]
        for price in prices:
            maxprofit = max(maxprofit, price - minprice)
            minprice = min(minprice, price)
        return maxprofit
```



# ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II

LeetCodeå…¥å£ğŸ‘‰ğŸ‘‰ğŸ‘‰[No.122](https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-ii/)

ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ *i* ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬ *i* å¤©çš„ä»·æ ¼ã€‚

è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚ä½ å¯ä»¥**å°½å¯èƒ½åœ°å®Œæˆæ›´å¤šçš„äº¤æ˜“**ï¼ˆ**å¤šæ¬¡ä¹°å–ä¸€æ”¯è‚¡ç¥¨**ï¼‰ã€‚

**æ³¨æ„ï¼š**ä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚

**ç¤ºä¾‹ 1:**

```python
è¾“å…¥: [7,1,5,3,6,4]
è¾“å‡º: 7
è§£é‡Š: åœ¨ç¬¬ 2 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 3 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 5ï¼‰çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 5-1 = 4 ã€‚
     éšåï¼Œåœ¨ç¬¬ 4 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 3ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 5 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 6ï¼‰çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 6-3 = 3 ã€‚
```

**ç¤ºä¾‹ 2:**

```python
è¾“å…¥: [1,2,3,4,5]
è¾“å‡º: 4
è§£é‡Š: åœ¨ç¬¬ 1 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 5 å¤© ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 5ï¼‰çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 5-1 = 4 ã€‚
     æ³¨æ„ä½ ä¸èƒ½åœ¨ç¬¬ 1 å¤©å’Œç¬¬ 2 å¤©æ¥è¿è´­ä¹°è‚¡ç¥¨ï¼Œä¹‹åå†å°†å®ƒä»¬å–å‡ºã€‚
     å› ä¸ºè¿™æ ·å±äºåŒæ—¶å‚ä¸äº†å¤šç¬”äº¤æ˜“ï¼Œä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ã€‚
```



**æ€è·¯**

- å³°è°·æ³•

åœ¨ä¸Šä¸€é¢˜åªå…è®¸ä¸€æ¬¡äº¤æ˜“ï¼Œæœ€å¤§åˆ©æ¶¦ä¸º Cï¼Œå¦‚æœå¯ä»¥å¤šæ¬¡äº¤æ˜“ï¼Œæ‰¾åˆ°==è¿ç»­çš„å³°å’Œè°·==ï¼Œä¸€å®šæ»¡è¶³ A+B>C ï¼ˆå¦‚ä¸‹å›¾ï¼‰

$TotalProfit=âˆ‘_i (peak_iâˆ’valley_i)$



![image-20200513105405559](https://gitee.com/gongyanzh/blogpic/raw/master/pictures/image-20200513105405559.png)

- è´ªå¿ƒğŸ’¡(é«˜é¢‘äº¤æ˜“çš„æœ¬è´¨)

åªè¦å‡ºç°ä¸€æ¬¡çˆ¬å‡å°±è®¡ç®—åˆ©æ¶¦

![image-20200513111848361](https://gitee.com/gongyanzh/blogpic/raw/master/pictures/image-20200513111848361.png)

**coding**

```python
#å³°è°·æ³•
class Solution:
    def maxProfit(self, prices: List[int]) -> int:
        if not prices:
            return 0
        maxprofit = 0
        i = 0
        while i < len(prices)-1:
            while i < len(prices)-1 and prices[i] >= prices[i+1]:
                i += 1
            valley = prices[i]  #is valley
            while i < len(prices)-1 and prices[i] <= prices[i+1]:
                i += 1    
            peak = prices[i]    #is peak
            
            maxprofit += peak - valley

        return maxprofit
#è´ªå¿ƒ
class Solution:
    def maxProfit(self, prices: List[int]) -> int:
        if not prices:
            return 0
        maxprofit = 0
        for i in range(1,len(prices)):
            if prices[i] > prices[i-1]:
                maxprofit += prices[i] - prices[i-1]

        return maxprofit
```



# ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III

LeetCodeå…¥å£ğŸ‘‰ğŸ‘‰ğŸ‘‰[No.123](https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-iii/)

ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ *i* ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šçš„è‚¡ç¥¨åœ¨ç¬¬ *i* å¤©çš„ä»·æ ¼ã€‚

è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚ä½ æœ€å¤šå¯ä»¥å®Œæˆ **ä¸¤ç¬” äº¤æ˜“**ã€‚

**æ³¨æ„:** ä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚

**ç¤ºä¾‹ 1:**

```python
è¾“å…¥: [3,3,5,0,0,3,1,4]
è¾“å‡º: 6
è§£é‡Š: åœ¨ç¬¬ 4 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 0ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 6 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 3ï¼‰çš„æ—¶å€™å–å‡ºï¼Œè¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 3-0 = 3 ã€‚
     éšåï¼Œåœ¨ç¬¬ 7 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 8 å¤© ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 4ï¼‰çš„æ—¶å€™å–å‡ºï¼Œè¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 4-1 = 3 ã€‚
```



**æ€è·¯**ï¼šåŠ¨æ€è§„åˆ’

çŠ¶æ€å®šä¹‰ï¼š

```python
dp[i][k][0/1]   åœ¨ç¬¬iå¤©ï¼Œæœ€å¤§äº¤æ˜“æ¬¡æ•°ä¸ºkï¼ŒæŒæœ‰çŠ¶æ€ä¸º0/1æ—¶çš„æœ€å¤§æ”¶ç›Š
```

çŠ¶æ€è½¬ç§»ï¼š

```python
dp[i][k][0] = max(dp[i-1][k][0], dp[i-1][k][1] + prices[i])		#åŒi-1å¤©çš„çŠ¶æ€ï¼Œæˆ–è€…ç¬¬iå¤©å–æ‰äº†
dp[i][k][1] = max(dp[i-1][k][1], dp[i-1][k-1][0] - prices[i])	#åŒi-1å¤©çš„çŠ¶æ€ï¼Œæˆ–è€…ç¬¬i-1å¤©ä¹°å…¥
```



åˆå§‹åŒ–ï¼š

```python
#ç¬¬0å¤©ï¼Œæ²¡æœ‰äº¤æ˜“ï¼Œæ²¡æŒæœ‰è‚¡ç¥¨ï¼Œæ”¶ç›Šä¸º0ï¼›æŒæœ‰è‚¡ç¥¨ï¼Œä¸å¯èƒ½äº‹ä»¶
dp[0][k][0] = 0
dp[0][k][1] = -infinity

#æœ€å¤§äº¤æ˜“æ¬¡æ•°ä¸º0ï¼Œæ²¡æœ‰äº¤æ˜“ï¼Œæ²¡æŒæœ‰è‚¡ç¥¨ï¼Œæ”¶ç›Šä¸º0ï¼›æŒæœ‰è‚¡ç¥¨ï¼Œä¸å¯èƒ½äº‹ä»¶
dp[i][0][0] = 0
dp[i][0][1] = -infinity
```

**coding**

```python
#åŠ¨æ€è§„åˆ’
class Solution:
    def maxProfit(self, prices: List[int]) -> int:
        if not prices:
            return 0
        k = 2
        n = len(prices)
        dp = [[[0]*2 for _ in range(k+1)] for _ in range(n+1)] #(n+1)*(k+1)*2: ä¸‹æ ‡0ä½œä¸ºè¾…åŠ©å…ƒç´ 
        
        #init
        for i in range(n+1):#äº¤æ˜“æ¬¡æ•°ä¸º0
            dp[i][0][0] = 0
            dp[i][0][1] = float('-inf')

        for j in range(k+1):#ç¬¬0å¤©
            dp[0][j][0] = 0
            dp[0][j][1] = float('-inf')
        
        #==# dpæ–¹æ³•ç¡®å®ä¼˜é›…
        for i in range(1,n+1):
            for j in range(1,k+1):
                #1 è¡¨ç¤ºæŒæœ‰
                dp[i][j][0] = max(dp[i-1][j][0],dp[i-1][j][1]+prices[i-1])
                dp[i][j][1] = max(dp[i-1][j][1],dp[i-1][j-1][0]-prices[i-1])

        return dp[-1][-1][0]
```



# me|æ€»ç»“

æ¶‰åŠçŠ¶æ€åœ¨åºåˆ—ä¸­äº§ç”Ÿå˜åŒ–çš„çš„æƒ…å¢ƒï¼Œéƒ½å¯ä»¥å°è¯•ç”¨åŠ¨æ€è§„åˆ’ï¼š => å½¢å¼å¾ˆä¼˜é›…

- æ‰”é¸¡è›‹
- viterbiç®—æ³•
- ä¹°å–è‚¡ç¥¨